Currently, I'm just trying to get it working so I can add it into my application.

I'm not satisfied with how it is now but this is the best full solution available, if I can get the time
or if someone would like to help me then I will work to imporve the interface and code.